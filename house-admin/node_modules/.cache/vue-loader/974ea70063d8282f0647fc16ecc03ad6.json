{"remainingRequest":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\vue-loader@15.10.1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\src\\layout\\components\\TagsView\\index.vue?vue&type=style&index=0&id=fac8ca64&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\src\\layout\\components\\TagsView\\index.vue","mtime":1682844148000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\css-loader@3.6.0\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\vue-loader@15.10.1\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\postcss-loader@3.0.0\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\sass-loader@10.1.1\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\vue-loader@15.10.1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnRhZ3Mtdmlldy1jb250YWluZXIgewogIGhlaWdodDogMzRweDsKICB3aWR0aDogMTAwJTsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZDhkY2U1OwogIGJveC1zaGFkb3c6IDAgMXB4IDNweCAwIHJnYmEoMCwgMCwgMCwgMC4xMiksIDAgMCAzcHggMCByZ2JhKDAsIDAsIDAsIDAuMDQpOwogIC50YWdzLXZpZXctd3JhcHBlciB7CiAgICAudGFncy12aWV3LWl0ZW0gewogICAgICBib3JkZXItcmFkaXVzOiAzcHg7CiAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIGhlaWdodDogMjZweDsKICAgICAgbGluZS1oZWlnaHQ6IDI2cHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNkOGRjZTU7CiAgICAgIGNvbG9yOiAjNDk1MDYwOwogICAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgICBwYWRkaW5nOiAwIDhweDsKICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICBtYXJnaW4tbGVmdDogNXB4OwogICAgICBtYXJnaW4tdG9wOiA0cHg7CiAgICAgICY6Zmlyc3Qtb2YtdHlwZSB7CiAgICAgICAgbWFyZ2luLWxlZnQ6IDE1cHg7CiAgICAgIH0KICAgICAgJjpsYXN0LW9mLXR5cGUgewogICAgICAgIG1hcmdpbi1yaWdodDogMTVweDsKICAgICAgfQogICAgICAmLmFjdGl2ZSB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzQyYjk4MzsKICAgICAgICBjb2xvcjogI2ZmZjsKICAgICAgICBib3JkZXItY29sb3I6ICM0MmI5ODM7CiAgICAgICAgJjo6YmVmb3JlIHsKICAgICAgICAgIGNvbnRlbnQ6ICIiOwogICAgICAgICAgYmFja2dyb3VuZDogI2ZmZjsKICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICAgICAgIHdpZHRoOiA4cHg7CiAgICAgICAgICBoZWlnaHQ6IDhweDsKICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgIG1hcmdpbi1yaWdodDogMnB4OwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICAuY29udGV4dG1lbnUgewogICAgbWFyZ2luOiAwOwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHotaW5kZXg6IDMwMDA7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBsaXN0LXN0eWxlLXR5cGU6IG5vbmU7CiAgICBwYWRkaW5nOiA1cHggMDsKICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgIGZvbnQtc2l6ZTogMTJweDsKICAgIGZvbnQtd2VpZ2h0OiA0MDA7CiAgICBjb2xvcjogIzMzMzsKICAgIGJveC1zaGFkb3c6IDJweCAycHggM3B4IDAgcmdiYSgwLCAwLCAwLCAwLjMpOwogICAgbGkgewogICAgICBtYXJnaW46IDA7CiAgICAgIHBhZGRpbmc6IDdweCAxNnB4OwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICY6aG92ZXIgewogICAgICAgIGJhY2tncm91bmQ6ICNlZWU7CiAgICAgIH0KICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/layout/components/TagsView","sourcesContent":["<template>\n  <div id=\"tags-view-container\" class=\"tags-view-container\">\n    <scroll-pane\n      ref=\"scrollPane\"\n      class=\"tags-view-wrapper\"\n      @scroll=\"handleScroll\"\n    >\n      <router-link\n        v-for=\"tag in visitedViews\"\n        ref=\"tag\"\n        :key=\"tag.path\"\n        :class=\"isActive(tag) ? 'active' : ''\"\n        :to=\"{ path: tag.path, query: tag.query, fullPath: tag.fullPath }\"\n        tag=\"span\"\n        class=\"tags-view-item\"\n        :style=\"activeStyle(tag)\"\n        @click.middle.native=\"!isAffix(tag) ? closeSelectedTag(tag) : ''\"\n        @contextmenu.prevent.native=\"openMenu(tag, $event)\"\n      >\n        {{ tag.title }}\n        <span\n          v-if=\"!isAffix(tag)\"\n          class=\"el-icon-close\"\n          @click.prevent.stop=\"closeSelectedTag(tag)\"\n        />\n      </router-link>\n    </scroll-pane>\n    <ul\n      v-show=\"visible\"\n      :style=\"{ left: left + 'px', top: top + 'px' }\"\n      class=\"contextmenu\"\n    >\n      <li @click=\"refreshSelectedTag(selectedTag)\">\n        <i class=\"el-icon-refresh-right\"></i> 刷新页面\n      </li>\n      <li v-if=\"!isAffix(selectedTag)\" @click=\"closeSelectedTag(selectedTag)\">\n        <i class=\"el-icon-close\"></i> 关闭当前\n      </li>\n      <li @click=\"closeOthersTags\">\n        <i class=\"el-icon-circle-close\"></i> 关闭其他\n      </li>\n      <li v-if=\"!isFirstView()\" @click=\"closeLeftTags\">\n        <i class=\"el-icon-back\"></i> 关闭左侧\n      </li>\n      <li v-if=\"!isLastView()\" @click=\"closeRightTags\">\n        <i class=\"el-icon-right\"></i> 关闭右侧\n      </li>\n      <li @click=\"closeAllTags(selectedTag)\">\n        <i class=\"el-icon-circle-close\"></i> 全部关闭\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport ScrollPane from \"./ScrollPane\";\nimport path from \"path\";\n\nexport default {\n  components: { ScrollPane },\n  data() {\n    return {\n      visible: false,\n      top: 0,\n      left: 0,\n      selectedTag: {},\n      affixTags: [],\n    };\n  },\n  computed: {\n    visitedViews() {\n      return this.$store.state.tagsView.visitedViews;\n    },\n    routes() {\n      return this.$store.state.permission.routes;\n    },\n    theme() {\n      return this.$store.state.settings.theme;\n    },\n  },\n  watch: {\n    $route() {\n      this.addTags();\n      this.moveToCurrentTag();\n    },\n    visible(value) {\n      if (value) {\n        document.body.addEventListener(\"click\", this.closeMenu);\n      } else {\n        document.body.removeEventListener(\"click\", this.closeMenu);\n      }\n    },\n  },\n  mounted() {\n    this.initTags();\n    this.addTags();\n  },\n  methods: {\n    isActive(route) {\n      return route.path === this.$route.path;\n    },\n    activeStyle(tag) {\n      if (!this.isActive(tag)) return {};\n      return {\n        \"background-color\": this.theme,\n        \"border-color\": this.theme,\n      };\n    },\n    isAffix(tag) {\n      return tag.meta && tag.meta.affix;\n    },\n    isFirstView() {\n      try {\n        return (\n          this.selectedTag.fullPath === this.visitedViews[1].fullPath ||\n          this.selectedTag.fullPath === \"/index\"\n        );\n      } catch (err) {\n        return false;\n      }\n    },\n    isLastView() {\n      try {\n        return (\n          this.selectedTag.fullPath ===\n          this.visitedViews[this.visitedViews.length - 1].fullPath\n        );\n      } catch (err) {\n        return false;\n      }\n    },\n    filterAffixTags(routes, basePath = \"/\") {\n      let tags = [];\n      routes.forEach((route) => {\n        if (route.meta && route.meta.affix) {\n          const tagPath = path.resolve(basePath, route.path);\n          tags.push({\n            fullPath: tagPath,\n            path: tagPath,\n            name: route.name,\n            meta: { ...route.meta },\n          });\n        }\n        if (route.children) {\n          const tempTags = this.filterAffixTags(route.children, route.path);\n          if (tempTags.length >= 1) {\n            tags = [...tags, ...tempTags];\n          }\n        }\n      });\n      return tags;\n    },\n    initTags() {\n      const affixTags = (this.affixTags = this.filterAffixTags(this.routes));\n      for (const tag of affixTags) {\n        // Must have tag name\n        if (tag.name) {\n          this.$store.dispatch(\"tagsView/addVisitedView\", tag);\n        }\n      }\n    },\n    addTags() {\n      const { name } = this.$route;\n      if (name) {\n        this.$store.dispatch(\"tagsView/addView\", this.$route);\n      }\n      return false;\n    },\n    moveToCurrentTag() {\n      const tags = this.$refs.tag;\n      this.$nextTick(() => {\n        for (const tag of tags) {\n          if (tag.to.path === this.$route.path) {\n            this.$refs.scrollPane.moveToTarget(tag);\n            // when query is different then update\n            if (tag.to.fullPath !== this.$route.fullPath) {\n              this.$store.dispatch(\"tagsView/updateVisitedView\", this.$route);\n            }\n            break;\n          }\n        }\n      });\n    },\n    refreshSelectedTag(view) {\n      this.$tab.refreshPage(view);\n    },\n    closeSelectedTag(view) {\n      this.$tab.closePage(view).then(({ visitedViews }) => {\n        if (this.isActive(view)) {\n          this.toLastView(visitedViews, view);\n        }\n      });\n    },\n    closeRightTags() {\n      this.$tab.closeRightPage(this.selectedTag).then((visitedViews) => {\n        if (!visitedViews.find((i) => i.fullPath === this.$route.fullPath)) {\n          this.toLastView(visitedViews);\n        }\n      });\n    },\n    closeLeftTags() {\n      this.$tab.closeLeftPage(this.selectedTag).then((visitedViews) => {\n        if (!visitedViews.find((i) => i.fullPath === this.$route.fullPath)) {\n          this.toLastView(visitedViews);\n        }\n      });\n    },\n    closeOthersTags() {\n      this.$router.push(this.selectedTag).catch(() => {});\n      this.$tab.closeOtherPage(this.selectedTag).then(() => {\n        this.moveToCurrentTag();\n      });\n    },\n    closeAllTags(view) {\n      this.$tab.closeAllPage().then(({ visitedViews }) => {\n        if (this.affixTags.some((tag) => tag.path === this.$route.path)) {\n          return;\n        }\n        this.toLastView(visitedViews, view);\n      });\n    },\n    toLastView(visitedViews, view) {\n      const latestView = visitedViews.slice(-1)[0];\n      if (latestView) {\n        this.$router.push(latestView.fullPath);\n      } else {\n        // now the default is to redirect to the home page if there is no tags-view,\n        // you can adjust it according to your needs.\n        if (view.name === \"Dashboard\") {\n          // to reload home page\n          this.$router.replace({ path: \"/redirect\" + view.fullPath });\n        } else {\n          this.$router.push(\"/\");\n        }\n      }\n    },\n    openMenu(tag, e) {\n      const menuMinWidth = 105;\n      const offsetLeft = this.$el.getBoundingClientRect().left; // container margin left\n      const offsetWidth = this.$el.offsetWidth; // container width\n      const maxLeft = offsetWidth - menuMinWidth; // left boundary\n      const left = e.clientX - offsetLeft + 15; // 15: margin right\n\n      if (left > maxLeft) {\n        this.left = maxLeft;\n      } else {\n        this.left = left;\n      }\n\n      this.top = e.clientY;\n      this.visible = true;\n      this.selectedTag = tag;\n    },\n    closeMenu() {\n      this.visible = false;\n    },\n    handleScroll() {\n      this.closeMenu();\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.tags-view-container {\n  height: 34px;\n  width: 100%;\n  background: #fff;\n  border-bottom: 1px solid #d8dce5;\n  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.12), 0 0 3px 0 rgba(0, 0, 0, 0.04);\n  .tags-view-wrapper {\n    .tags-view-item {\n      border-radius: 3px;\n      display: inline-block;\n      position: relative;\n      cursor: pointer;\n      height: 26px;\n      line-height: 26px;\n      border: 1px solid #d8dce5;\n      color: #495060;\n      background: #fff;\n      padding: 0 8px;\n      font-size: 12px;\n      margin-left: 5px;\n      margin-top: 4px;\n      &:first-of-type {\n        margin-left: 15px;\n      }\n      &:last-of-type {\n        margin-right: 15px;\n      }\n      &.active {\n        background-color: #42b983;\n        color: #fff;\n        border-color: #42b983;\n        &::before {\n          content: \"\";\n          background: #fff;\n          display: inline-block;\n          width: 8px;\n          height: 8px;\n          border-radius: 50%;\n          position: relative;\n          margin-right: 2px;\n        }\n      }\n    }\n  }\n  .contextmenu {\n    margin: 0;\n    background: #fff;\n    z-index: 3000;\n    position: absolute;\n    list-style-type: none;\n    padding: 5px 0;\n    border-radius: 4px;\n    font-size: 12px;\n    font-weight: 400;\n    color: #333;\n    box-shadow: 2px 2px 3px 0 rgba(0, 0, 0, 0.3);\n    li {\n      margin: 0;\n      padding: 7px 16px;\n      cursor: pointer;\n      &:hover {\n        background: #eee;\n      }\n    }\n  }\n}\n</style>\n\n<style lang=\"scss\">\n//reset element css of el-icon-close\n.tags-view-wrapper {\n  .tags-view-item {\n    .el-icon-close {\n      width: 16px;\n      height: 16px;\n      vertical-align: 2px;\n      border-radius: 50%;\n      text-align: center;\n      transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\n      transform-origin: 100% 50%;\n      &:before {\n        transform: scale(0.6);\n        display: inline-block;\n        vertical-align: -3px;\n      }\n      &:hover {\n        background-color: #b4bccc;\n        color: #fff;\n      }\n    }\n  }\n}\n</style>\n"]}]}