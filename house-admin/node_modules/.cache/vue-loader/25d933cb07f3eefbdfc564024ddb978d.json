{"remainingRequest":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\vue-loader@15.10.1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\src\\views\\tool\\gen\\editTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\src\\views\\tool\\gen\\editTable.vue","mtime":1682901618000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\babel-loader@8.3.0\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\cache-loader@4.1.0\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\xubo\\Desktop\\房屋租赁项目\\house-admin\\node_modules\\.store\\vue-loader@15.10.1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEdlblRhYmxlLCB1cGRhdGVHZW5UYWJsZSB9IGZyb20gIkAvYXBpL3Rvb2wvZ2VuIjsKaW1wb3J0IHsgb3B0aW9uc2VsZWN0IGFzIGdldERpY3RPcHRpb25zZWxlY3QgfSBmcm9tICJAL2FwaS9zeXN0ZW0vZGljdC90eXBlIjsKaW1wb3J0IHsgbGlzdE1lbnUgYXMgZ2V0TWVudVRyZWVzZWxlY3QgfSBmcm9tICJAL2FwaS9zeXN0ZW0vbWVudSI7CmltcG9ydCBiYXNpY0luZm9Gb3JtIGZyb20gIi4vYmFzaWNJbmZvRm9ybSI7CmltcG9ydCBnZW5JbmZvRm9ybSBmcm9tICIuL2dlbkluZm9Gb3JtIjsKaW1wb3J0IFNvcnRhYmxlIGZyb20gInNvcnRhYmxlanMiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJHZW5FZGl0IiwKICBjb21wb25lbnRzOiB7CiAgICBiYXNpY0luZm9Gb3JtLAogICAgZ2VuSW5mb0Zvcm0sCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g6YCJ5Lit6YCJ6aG55Y2h55qEIG5hbWUKICAgICAgYWN0aXZlTmFtZTogImNvbHVtbkluZm8iLAogICAgICAvLyDooajmoLznmoTpq5jluqYKICAgICAgdGFibGVIZWlnaHQ6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQgLSAyNDUgKyAicHgiLAogICAgICAvLyDooajkv6Hmga8KICAgICAgdGFibGVzOiBbXSwKICAgICAgLy8g6KGo5YiX5L+h5oGvCiAgICAgIGNvbHVtbnM6IFtdLAogICAgICAvLyDlrZflhbjkv6Hmga8KICAgICAgZGljdE9wdGlvbnM6IFtdLAogICAgICAvLyDoj5zljZXkv6Hmga8KICAgICAgbWVudXM6IFtdLAogICAgICAvLyDooajor6bnu4bkv6Hmga8KICAgICAgaW5mbzoge30sCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGNvbnN0IHRhYmxlSWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMgJiYgdGhpcy4kcm91dGUucGFyYW1zLnRhYmxlSWQ7CiAgICBpZiAodGFibGVJZCkgewogICAgICAvLyDojrflj5booajor6bnu4bkv6Hmga8KICAgICAgZ2V0R2VuVGFibGUodGFibGVJZCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy5jb2x1bW5zID0gcmVzLmRhdGEucm93czsKICAgICAgICB0aGlzLmluZm8gPSByZXMuZGF0YS5pbmZvOwogICAgICAgIHRoaXMudGFibGVzID0gcmVzLmRhdGEudGFibGVzOwogICAgICB9KTsKICAgICAgLyoqIOafpeivouWtl+WFuOS4i+aLieWIl+ihqCAqLwogICAgICBnZXREaWN0T3B0aW9uc2VsZWN0KCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICB0aGlzLmRpY3RPcHRpb25zID0gcmVzcG9uc2UuZGF0YTsKICAgICAgfSk7CiAgICAgIC8qKiDmn6Xor6Loj5zljZXkuIvmi4nliJfooaggKi8KICAgICAgZ2V0TWVudVRyZWVzZWxlY3QoKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIHRoaXMubWVudXMgPSB0aGlzLmhhbmRsZVRyZWUocmVzcG9uc2UuZGF0YSwgIm1lbnVJZCIpOwogICAgICB9KTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8qKiDmj5DkuqTmjInpkq4gKi8KICAgIHN1Ym1pdEZvcm0oKSB7CiAgICAgIGNvbnN0IGJhc2ljRm9ybSA9IHRoaXMuJHJlZnMuYmFzaWNJbmZvLiRyZWZzLmJhc2ljSW5mb0Zvcm07CiAgICAgIGNvbnN0IGdlbkZvcm0gPSB0aGlzLiRyZWZzLmdlbkluZm8uJHJlZnMuZ2VuSW5mb0Zvcm07CiAgICAgIFByb21pc2UuYWxsKFtiYXNpY0Zvcm0sIGdlbkZvcm1dLm1hcCh0aGlzLmdldEZvcm1Qcm9taXNlKSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgY29uc3QgdmFsaWRhdGVSZXN1bHQgPSByZXMuZXZlcnkoKGl0ZW0pID0+ICEhaXRlbSk7CiAgICAgICAgaWYgKHZhbGlkYXRlUmVzdWx0KSB7CiAgICAgICAgICBjb25zdCBnZW5UYWJsZSA9IE9iamVjdC5hc3NpZ24oe30sIGJhc2ljRm9ybS5tb2RlbCwgZ2VuRm9ybS5tb2RlbCk7CiAgICAgICAgICBnZW5UYWJsZS5jb2x1bW5zID0gdGhpcy5jb2x1bW5zOwogICAgICAgICAgZ2VuVGFibGUucGFyYW1zID0gewogICAgICAgICAgICB0cmVlQ29kZTogZ2VuVGFibGUudHJlZUNvZGUsCiAgICAgICAgICAgIHRyZWVOYW1lOiBnZW5UYWJsZS50cmVlTmFtZSwKICAgICAgICAgICAgdHJlZVBhcmVudENvZGU6IGdlblRhYmxlLnRyZWVQYXJlbnRDb2RlLAogICAgICAgICAgICBwYXJlbnRNZW51SWQ6IGdlblRhYmxlLnBhcmVudE1lbnVJZCwKICAgICAgICAgIH07CiAgICAgICAgICB1cGRhdGVHZW5UYWJsZShnZW5UYWJsZSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MocmVzLm1zZyk7CiAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbW9kYWwubXNnRXJyb3IoIuihqOWNleagoemqjOacqumAmui/h++8jOivt+mHjeaWsOajgOafpeaPkOS6pOWGheWuuSIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZ2V0Rm9ybVByb21pc2UoZm9ybSkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBmb3JtLnZhbGlkYXRlKChyZXMpID0+IHsKICAgICAgICAgIHJlc29sdmUocmVzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLyoqIOWFs+mXreaMiemSriAqLwogICAgY2xvc2UoKSB7CiAgICAgIGNvbnN0IG9iaiA9IHsKICAgICAgICBwYXRoOiAiL3Rvb2wvZ2VuIiwKICAgICAgICBxdWVyeTogeyB0OiBEYXRlLm5vdygpLCBwYWdlTnVtOiAxIH0sCiAgICAgIH07CiAgICAgIHRoaXMuJHRhYi5jbG9zZU9wZW5QYWdlKG9iaik7CiAgICB9LAogIH0sCiAgbW91bnRlZCgpIHsKICAgIGNvbnN0IGVsID0gdGhpcy4kcmVmcy5kcmFnVGFibGUuJGVsLnF1ZXJ5U2VsZWN0b3JBbGwoCiAgICAgICIuZWwtdGFibGVfX2JvZHktd3JhcHBlciA+IHRhYmxlID4gdGJvZHkiCiAgICApWzBdOwogICAgY29uc3Qgc29ydGFibGUgPSBTb3J0YWJsZS5jcmVhdGUoZWwsIHsKICAgICAgaGFuZGxlOiAiLmFsbG93RHJhZyIsCiAgICAgIG9uRW5kOiAoZXZ0KSA9PiB7CiAgICAgICAgY29uc3QgdGFyZ2V0Um93ID0gdGhpcy5jb2x1bW5zLnNwbGljZShldnQub2xkSW5kZXgsIDEpWzBdOwogICAgICAgIHRoaXMuY29sdW1ucy5zcGxpY2UoZXZ0Lm5ld0luZGV4LCAwLCB0YXJnZXRSb3cpOwogICAgICAgIGZvciAobGV0IGluZGV4IGluIHRoaXMuY29sdW1ucykgewogICAgICAgICAgdGhpcy5jb2x1bW5zW2luZGV4XS5zb3J0ID0gcGFyc2VJbnQoaW5kZXgpICsgMTsKICAgICAgICB9CiAgICAgIH0sCiAgICB9KTsKICB9LAp9Owo="},{"version":3,"sources":["editTable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8KA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"editTable.vue","sourceRoot":"src/views/tool/gen","sourcesContent":["<template>\n  <el-card>\n    <el-tabs v-model=\"activeName\">\n      <el-tab-pane label=\"基本信息\" name=\"basic\">\n        <basic-info-form ref=\"basicInfo\" :info=\"info\" />\n      </el-tab-pane>\n      <el-tab-pane label=\"字段信息\" name=\"columnInfo\">\n        <el-table\n          ref=\"dragTable\"\n          :data=\"columns\"\n          row-key=\"columnId\"\n          :max-height=\"tableHeight\"\n        >\n          <el-table-column\n            label=\"序号\"\n            type=\"index\"\n            min-width=\"5%\"\n            class-name=\"allowDrag\"\n          />\n          <el-table-column\n            label=\"字段列名\"\n            prop=\"columnName\"\n            min-width=\"10%\"\n            :show-overflow-tooltip=\"true\"\n          />\n          <el-table-column label=\"字段描述\" min-width=\"10%\">\n            <template slot-scope=\"scope\">\n              <el-input v-model=\"scope.row.columnComment\"></el-input>\n            </template>\n          </el-table-column>\n          <el-table-column\n            label=\"物理类型\"\n            prop=\"columnType\"\n            min-width=\"10%\"\n            :show-overflow-tooltip=\"true\"\n          />\n          <el-table-column label=\"Java类型\" min-width=\"11%\">\n            <template slot-scope=\"scope\">\n              <el-select v-model=\"scope.row.javaType\">\n                <el-option label=\"Long\" value=\"Long\" />\n                <el-option label=\"String\" value=\"String\" />\n                <el-option label=\"Integer\" value=\"Integer\" />\n                <el-option label=\"Double\" value=\"Double\" />\n                <el-option label=\"BigDecimal\" value=\"BigDecimal\" />\n                <el-option label=\"Date\" value=\"Date\" />\n                <el-option label=\"Boolean\" value=\"Boolean\" />\n              </el-select>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"java属性\" min-width=\"10%\">\n            <template slot-scope=\"scope\">\n              <el-input v-model=\"scope.row.javaField\"></el-input>\n            </template>\n          </el-table-column>\n\n          <el-table-column label=\"插入\" min-width=\"5%\">\n            <template slot-scope=\"scope\">\n              <el-checkbox\n                true-label=\"1\"\n                false-label=\"0\"\n                v-model=\"scope.row.isInsert\"\n              ></el-checkbox>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"编辑\" min-width=\"5%\">\n            <template slot-scope=\"scope\">\n              <el-checkbox\n                true-label=\"1\"\n                false-label=\"0\"\n                v-model=\"scope.row.isEdit\"\n              ></el-checkbox>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"列表\" min-width=\"5%\">\n            <template slot-scope=\"scope\">\n              <el-checkbox\n                true-label=\"1\"\n                false-label=\"0\"\n                v-model=\"scope.row.isList\"\n              ></el-checkbox>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"查询\" min-width=\"5%\">\n            <template slot-scope=\"scope\">\n              <el-checkbox\n                true-label=\"1\"\n                false-label=\"0\"\n                v-model=\"scope.row.isQuery\"\n              ></el-checkbox>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"查询方式\" min-width=\"10%\">\n            <template slot-scope=\"scope\">\n              <el-select v-model=\"scope.row.queryType\">\n                <el-option label=\"=\" value=\"EQ\" />\n                <el-option label=\"!=\" value=\"NE\" />\n                <el-option label=\">\" value=\"GT\" />\n                <el-option label=\">=\" value=\"GTE\" />\n                <el-option label=\"<\" value=\"LT\" />\n                <el-option label=\"<=\" value=\"LTE\" />\n                <el-option label=\"LIKE\" value=\"LIKE\" />\n                <el-option label=\"BETWEEN\" value=\"BETWEEN\" />\n              </el-select>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"必填\" min-width=\"5%\">\n            <template slot-scope=\"scope\">\n              <el-checkbox\n                true-label=\"1\"\n                false-label=\"0\"\n                v-model=\"scope.row.isRequired\"\n              ></el-checkbox>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"显示类型\" min-width=\"12%\">\n            <template slot-scope=\"scope\">\n              <el-select v-model=\"scope.row.htmlType\">\n                <el-option label=\"文本框\" value=\"input\" />\n                <el-option label=\"文本域\" value=\"textarea\" />\n                <el-option label=\"下拉框\" value=\"select\" />\n                <el-option label=\"单选框\" value=\"radio\" />\n                <el-option label=\"复选框\" value=\"checkbox\" />\n                <el-option label=\"日期控件\" value=\"datetime\" />\n                <el-option label=\"图片上传\" value=\"imageUpload\" />\n                <el-option label=\"文件上传\" value=\"fileUpload\" />\n                <el-option label=\"富文本控件\" value=\"editor\" />\n              </el-select>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"字典类型\" min-width=\"12%\">\n            <template slot-scope=\"scope\">\n              <el-select\n                v-model=\"scope.row.dictType\"\n                clearable\n                filterable\n                placeholder=\"请选择\"\n              >\n                <el-option\n                  v-for=\"dict in dictOptions\"\n                  :key=\"dict.dictType\"\n                  :label=\"dict.dictName\"\n                  :value=\"dict.dictType\"\n                >\n                  <span style=\"float: left\">{{ dict.dictName }}</span>\n                  <span style=\"float: right; color: #8492a6; font-size: 13px\">{{\n                    dict.dictType\n                  }}</span>\n                </el-option>\n              </el-select>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-tab-pane>\n      <el-tab-pane label=\"生成信息\" name=\"genInfo\">\n        <gen-info-form\n          ref=\"genInfo\"\n          :info=\"info\"\n          :tables=\"tables\"\n          :menus=\"menus\"\n        />\n      </el-tab-pane>\n    </el-tabs>\n    <el-form label-width=\"100px\">\n      <el-form-item\n        style=\"text-align: center; margin-left: -100px; margin-top: 10px\"\n      >\n        <el-button type=\"primary\" @click=\"submitForm()\">提交</el-button>\n        <el-button @click=\"close()\">返回</el-button>\n      </el-form-item>\n    </el-form>\n  </el-card>\n</template>\n\n<script>\nimport { getGenTable, updateGenTable } from \"@/api/tool/gen\";\nimport { optionselect as getDictOptionselect } from \"@/api/system/dict/type\";\nimport { listMenu as getMenuTreeselect } from \"@/api/system/menu\";\nimport basicInfoForm from \"./basicInfoForm\";\nimport genInfoForm from \"./genInfoForm\";\nimport Sortable from \"sortablejs\";\n\nexport default {\n  name: \"GenEdit\",\n  components: {\n    basicInfoForm,\n    genInfoForm,\n  },\n  data() {\n    return {\n      // 选中选项卡的 name\n      activeName: \"columnInfo\",\n      // 表格的高度\n      tableHeight: document.documentElement.scrollHeight - 245 + \"px\",\n      // 表信息\n      tables: [],\n      // 表列信息\n      columns: [],\n      // 字典信息\n      dictOptions: [],\n      // 菜单信息\n      menus: [],\n      // 表详细信息\n      info: {},\n    };\n  },\n  created() {\n    const tableId = this.$route.params && this.$route.params.tableId;\n    if (tableId) {\n      // 获取表详细信息\n      getGenTable(tableId).then((res) => {\n        this.columns = res.data.rows;\n        this.info = res.data.info;\n        this.tables = res.data.tables;\n      });\n      /** 查询字典下拉列表 */\n      getDictOptionselect().then((response) => {\n        this.dictOptions = response.data;\n      });\n      /** 查询菜单下拉列表 */\n      getMenuTreeselect().then((response) => {\n        this.menus = this.handleTree(response.data, \"menuId\");\n      });\n    }\n  },\n  methods: {\n    /** 提交按钮 */\n    submitForm() {\n      const basicForm = this.$refs.basicInfo.$refs.basicInfoForm;\n      const genForm = this.$refs.genInfo.$refs.genInfoForm;\n      Promise.all([basicForm, genForm].map(this.getFormPromise)).then((res) => {\n        const validateResult = res.every((item) => !!item);\n        if (validateResult) {\n          const genTable = Object.assign({}, basicForm.model, genForm.model);\n          genTable.columns = this.columns;\n          genTable.params = {\n            treeCode: genTable.treeCode,\n            treeName: genTable.treeName,\n            treeParentCode: genTable.treeParentCode,\n            parentMenuId: genTable.parentMenuId,\n          };\n          updateGenTable(genTable).then((res) => {\n            this.$modal.msgSuccess(res.msg);\n            if (res.code === 200) {\n              this.close();\n            }\n          });\n        } else {\n          this.$modal.msgError(\"表单校验未通过，请重新检查提交内容\");\n        }\n      });\n    },\n    getFormPromise(form) {\n      return new Promise((resolve) => {\n        form.validate((res) => {\n          resolve(res);\n        });\n      });\n    },\n    /** 关闭按钮 */\n    close() {\n      const obj = {\n        path: \"/tool/gen\",\n        query: { t: Date.now(), pageNum: 1 },\n      };\n      this.$tab.closeOpenPage(obj);\n    },\n  },\n  mounted() {\n    const el = this.$refs.dragTable.$el.querySelectorAll(\n      \".el-table__body-wrapper > table > tbody\"\n    )[0];\n    const sortable = Sortable.create(el, {\n      handle: \".allowDrag\",\n      onEnd: (evt) => {\n        const targetRow = this.columns.splice(evt.oldIndex, 1)[0];\n        this.columns.splice(evt.newIndex, 0, targetRow);\n        for (let index in this.columns) {\n          this.columns[index].sort = parseInt(index) + 1;\n        }\n      },\n    });\n  },\n};\n</script>\n"]}]}