{"version":3,"sources":["webpack:////Users/mac/projects/house/house-life/components/likeFx/likeFx.vue?7587","webpack:////Users/mac/projects/house/house-life/components/likeFx/likeFx.vue?7cba","webpack:////Users/mac/projects/house/house-life/components/likeFx/likeFx.vue?3822","webpack:////Users/mac/projects/house/house-life/components/likeFx/likeFx.vue?f4ea","uni-app:///components/likeFx/likeFx.vue","webpack:////Users/mac/projects/house/house-life/components/likeFx/likeFx.vue?b804","webpack:////Users/mac/projects/house/house-life/components/likeFx/likeFx.vue?f6d2"],"names":["name","data","queue","ctx","timer","props","height","type","default","width","mounted","console","destroyed","methods","likeClick","id","opacity","pathData","image","factor","speed","t","getRandom","getRandomInt","generatePathData","x","y","updatePath","bubbleAnimate","Object","anmationData","curWidth","curAlpha","clearTimer","clearTimeout"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;AACc;;;AAGnE;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAo0B,CAAgB,oyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;eCOx1B;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;MACAC;IACA;EACA;EACAE;IACA;IACA;IACAC;EACA;EACAC;IACAD;IACA;EACA;EACAE;IACA,QACAC;MACAH;MACA;MACA;QACAI;QACAX;QACAY;QACAC;QACAC;QACAC;UACA;UACA;UACAC;UAAA;UACAC;QACA;MACA;;MACA;QACA;MACA;QACA;QACA;MACA;;MAEA;IACA;IACA,eACAC;MACA;IACA;IACA,oBACAC;MACA;IACA;IACA,YACAC;MACA;QACAlB;MACA;QACAmB;QACAC;MACA;MACA;QACAD;QACAC;MACA;MACA;QACAD;QACAC;MACA;MACA;QACAD;QACAC;MACA;MACA;IACA;IACA,iBACAC;MACA;MACA;MACA;MACA;MAEA;;MAEA;MACA;MACA;MACA;MAEA;MACA;MACA;MAEA;MACA;MACA;MACA;QACAF;QACAC;MACA;IACA;IACA,UACAE;MAAA;MACA;QACAtB;MACAuB;QACA;QACA,uBAGA,iBACAC,uBACAA,oBACA;UALAL;UACAC;QAKA;QACAI;QAEA;QACAC;QACAA;QAEA;QACAC;QACAA;QACA;QACA;QACA;QACA;QACA;UACA;QACA;QACA;UACA;QACA;MACA;MACA;MACA;QACA;UACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAC;MACA;QACAC;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACxKA;AAAA;AAAA;AAAA;AAAmiD,CAAgB,m6CAAG,EAAC,C;;;;;;;;;;;ACAvjD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/likeFx/likeFx.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./likeFx.vue?vue&type=template&id=2e335c24&\"\nvar renderjs\nimport script from \"./likeFx.vue?vue&type=script&lang=js&\"\nexport * from \"./likeFx.vue?vue&type=script&lang=js&\"\nimport style0 from \"./likeFx.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/likeFx/likeFx.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./likeFx.vue?vue&type=template&id=2e335c24&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./likeFx.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./likeFx.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"\">\n    <canvas canvas-id=\"bubble\" :style=\"'width:' + width + 'px;height:' + height + 'px'\" class=\"like-fx\"></canvas>\n  </view>\n</template>\n\n<script>\n  export default {\n    name: 'LikeFx',\n    data() {\n      return {\n        queue: {},\n        ctx: null,\n        timer: 0\n      }\n    },\n    props: {\n      height: {\n        type: Number,\n        default: 1920\n      },\n      width: {\n        type: Number,\n        default: 375\n      }\n    },\n    mounted() {\n      this.ctx = uni.createCanvasContext(\"bubble\")\n      this.queue = {}\n      console.log('likeFx mounted');\n    },\n    destroyed() {\n      console.log('likeFx destoryed');\n      this.clearTimer()\n    },\n    methods: {\n      /**点赞 */\n      likeClick() {\n\t\tconsole.log('开始点赞啦');\n        const image = \"/static/img/likeFx/\" + this.getRandomInt(1, 33) + \".png\";\n        const anmationData = {\n          id: new Date().getTime(),\n          timer: 0,\n          opacity: 0,\n          pathData: this.generatePathData(),\n          image: image,\n          factor: {\n            // speed: 0.0009, // 运动速度，值越小越慢\n            // t: 0.4//  贝塞尔函数系数，当为0，就是从无到有，这时候屏幕高度也要调一下\n            speed: 0.0006, // 运动速度，值越小越慢\n            t: 0.6 //  贝塞尔函数系数，当为0，就是从无到有，这时候屏幕高度也要调一下\n          }\n        };\n        if (Object.keys(this.queue).length > 0) {\n          this.queue[anmationData.id] = anmationData;\n        } else {\n          this.queue[anmationData.id] = anmationData;\n          this.bubbleAnimate();\n        }\n        \n        // console.log(image, this.queue);\n      },\n      /**获取最大最小随机值 */\n      getRandom(min, max) {\n        return Math.random() * (max - min) + min;\n      },\n      /**获取最大最小之前随机值的整数 */\n      getRandomInt(min, max) {\n        return Math.floor(Math.random() * (max - min + 1)) + min;\n      },\n      /**获取图片路径 */\n      generatePathData() {\n        let width = this.width,\n          height = this.height;\n        const p0 = {\n          x: 0.72 * width,\n          y: height\n        };\n        const p1 = {\n          x: this.getRandom(0.22 * width, 0.33 * width),\n          y: this.getRandom(0.5 * height, 0.75 * height)\n        };\n        const p2 = {\n          x: this.getRandom(0, 0.88 * width),\n          y: this.getRandom(0.25 * height, 0.5 * height)\n        };\n        const p3 = {\n          x: this.getRandom(0, 0.88 * width),\n          y: this.getRandom(0, 0.125 * height)\n        };\n        return [p0, p1, p2, p3];\n      },\n      /**更新图片的最新运动路径 */\n      updatePath(data, factor) {\n        const p0 = data[0];\n        const p1 = data[1];\n        const p2 = data[2];\n        const p3 = data[3];\n\n        const t = factor.t;\n\n        /*计算多项式系数 （下同）*/\n        const cx1 = 3 * (p1.x - p0.x);\n        const bx1 = 3 * (p2.x - p1.x) - cx1;\n        const ax1 = p3.x - p0.x - cx1 - bx1;\n\n        const cy1 = 3 * (p1.y - p0.y);\n        const by1 = 3 * (p2.y - p1.y) - cy1;\n        const ay1 = p3.y - p0.y - cy1 - by1;\n\n        const x = ax1 * (t * t * t) + bx1 * (t * t) + cx1 * t + p0.x;\n        const y = ay1 * (t * t * t) + by1 * (t * t) + cy1 * t + p0.y;\n        // console.log(data, x, y);\n        return {\n          x,\n          y\n        };\n      },\n      /**点赞动画 */\n      bubbleAnimate() {\n        let width = this.width,\n          height = this.height;\n        Object.keys(this.queue).forEach(key => {\n          const anmationData = this.queue[+key];\n          const {\n            x,\n            y\n          } = this.updatePath(\n            anmationData.pathData,\n            anmationData.factor\n          );\n          const speed = anmationData.factor.speed;\n          anmationData.factor.t += speed;\n\n          var curWidth = 30;\n          curWidth = (height - y) / 1.5;\n          curWidth = Math.min(30, curWidth);\n\n          var curAlpha = anmationData.opacity;\n          curAlpha = y / (0.3 * height); //消失的高度适当调一下\n          curAlpha = Math.min(1, curAlpha);\n          this.ctx.globalAlpha = curAlpha;\n          this.ctx.drawImage(anmationData.image, x - curWidth / 2, y, curWidth, curWidth);\n          // this.ctx.setFillStyle('red')\n          // this.ctx.fillRect(x - curWidth / 2, y, 50, 50)\n          if (anmationData.factor.t > 1) {\n            delete this.queue[anmationData.id];\n          }\n          if (y > height) {\n            delete this.queue[anmationData.id];\n          }\n        });\n        this.ctx.draw();\n        if (Object.keys(this.queue).length > 0) {\n          this.timer = setTimeout(() => {\n            this.bubbleAnimate();\n          }, 5);\n        } else {\n          this.clearTimer()\n          this.ctx.draw(); // 清空画面\n        }\n      },\n      clearTimer() {\n        if (this.timer) {\n          clearTimeout(this.timer)\n        }\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .like-fx {\n    position: fixed;\n    right: 0;\n    z-index: 1024;\n    pointer-events: none;\n    /* background-color: red; */\n  }\n</style>\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./likeFx.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./likeFx.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1683620600203\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}